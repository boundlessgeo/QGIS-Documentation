<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Expressions</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-2.3.2/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/qgis-style.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-2.3.2/css/bootstrap-responsive.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     'testing',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/qgis-site.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
    <link rel="shortcut icon" href="../../../_static/images/favicon.ico?1322140996"/>
    <link rel="top" title="" href="../../../index.html" />
    <link rel="up" title="Working with Vector Data" href="index.html" />
    <link rel="next" title="Working with the Attribute Table" href="attribute_table.html" />
    <link rel="prev" title="The Vector Properties Dialog" href="vector_properties.html" />
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
    <meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>



    
  <div id="navbar" class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="../../index.html">QGIS Documentation Project</a>
        <span class="navbar-text pull-left"><b>testing</b></span>
        
          <select id="languages">
  <!-- note on the options here: the 'title' string is to be translated in your
  language, but the element text is supposed to stay in native lang/txt -->
  <option value="en" title="English">English</option>
<!--  <option value="ca_ES" title="Catalan">Catalan</option>
  <option value="da_DK" title="Danish">Dansk</option>
  <option value="de" title="German">Deutsch</option>
  <option value="es" title="Spanish">Español</option>
  <option value="fa" title="Persian">فارسی</option>
  <option value="fi" title="Finnish">Suomalainen</option>
  <option value="fr" title="French">Français</option>
  <option value="id" title="Indonesian">Bahasa Indonesia</option>
  <option value="it" title="Italian">Italiano</option>
  <option value="ja" title="Japanese">日本語</option>
  <option value="ko_KR" title="Korean">한국어</option>
  <option value="nl" title="Dutch">Nederlands</option>
  <option value="pt_PT" title="Portuguese">Português</option>
  <option value="ro" title="Romanian">Română</option>
  <option value="ru" title="Russian">Русский</option>
  <option value="zh_CN" title="Chinese (China)">中文</option>
  <option value="zh_TW" title="Chinese (Taiwan)">Chinese (Taiwan)</option> -->
</select>

<script>
    var currentPage = 'docs/user_manual/working_with_vector/expression.html'; // coming from sphinx, always without starting '/'
    var currentLang = 'en';
    // split index.html if currentUrl is ended by '/'
    var currentUrl = window.location.href;
    if (currentUrl.slice(-1) == '/' && currentPage.slice(-1) != '/'){
      var pages = currentPage.split('/');
      pages.pop();
      currentPage = pages.join('/') + '/';
    }
    $(document).ready(function(){
        var search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
        var langPlusPage = window.location.href.match(search);
        // it's possible this is the index.html page called without 'index.html', try without the currentPage
        if (langPlusPage==undefined){
            search = new RegExp('\/[a-zA-Z_]{2,8}\/$', 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // it's possible this is an index.html page called without 'index.html', try removing index.html
        if (langPlusPage==undefined){
            currentPage = currentPage.replace('index.html','')
            search = new RegExp('\/[a-zA-Z_]{2,8}\/'+ currentPage, 'gi');
            langPlusPage = window.location.href.match(search);
        }
        // still no langPlugPage: stop, because the language swicher will misbehave
        if (langPlusPage == undefined || langPlusPage.length != 1){
            alert('This is an documentation error, please report back to QGIS devs.');
            return;
        }
        langPlusPage = langPlusPage[0];
        currentLang = langPlusPage.replace(currentPage, '');

        // TODO: links should come from conf.py
        // TODO: all template pages have the actual translation in sphinc.conf
        // documentation master only github links
        /*
        fix_translation_link = 'https://www.transifex.com/projects/p/qgis-website/translate/#' + 
            currentLang.slice(1) + currentPage.replace(/\//g, "_").replace(/-/g, "_").replace(/\.html/g, "")
        if ('/en/' != currentLang) {
            $('#fix_translation_link').attr('href', fix_translation_link);
        }
        */
        fix_text_link = 'https://github.com/qgis/QGIS-Documentation/edit/master/source/' +
            currentPage.replace(/.html/g, ".rst")
        // TODO: only on rst pages, here a list of pages which are actual templates?
        if (true){
            $('#fix_text_link').attr('href', fix_text_link);
        }

        $("#languages").val(currentLang.replace(/\//g,'')); // currentLang is something like '/nl/'

        $("#languages").change(function() {
            gotoLang($(this).val());
        });

    });

    // load current page in a different language
    function gotoLang(lang){
        var currentUrl = window.location.href;
        var newUrl = currentUrl.replace(currentLang, '/'+lang+'/');
        window.location.href = newUrl;
    }
</script>
        
        <div class="nav-collapse collapse">
          <ul class="unstyled nav main-menu">
            <!--<li><a href="../../../site/about/index.html">Discover QGIS</a></li>
            <li><a href="../../../site/forusers/index.html">For Users</a></li>
            <li><a href="../../../site/getinvolved/index.html">Get Involved</a></li>
            <li><a href="../../index.html">Documentation</a></li>-->
            <li><a href="../../index.html">Documentation QGIS testing</a></li>
            <li>
          
<form class="navbar-search" action="../../../search.html" method="get">
  <input type="text" name="q" class="search-query" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

    
    <div class="related">
       
      
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="attribute_table.html" title="Working with the Attribute Table"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="vector_properties.html" title="The Vector Properties Dialog"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html"></a> &raquo;</li>
          <li><a href="../index.html" >QGIS User Guide</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Working with Vector Data</a> &raquo;</li> 
      </ul>
    </div>
    <div style="display:none;" class="container" id="nextprev" >
    
    <a accesskey="p" href="vector_properties.html">&lt;&lt; prev</a>
    
    
    <a accesskey="n" href="attribute_table.html">next &gt;&gt;</a>
    
    </div>




    
        <div class="container">
            <div class="row">
      <div class="span4">
        <div id="sidebar" class="bs-sidenav well" data-spy="scroll">
<h3><a href="../../index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User guide/Manual (QGIS Testing!)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../preamble/preamble.html">Preamble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/conventions.html">Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/foreword.html">Foreword</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/features.html">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/whats_new.html">What&#8217;s new in QGIS testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/qgis_gui.html">QGIS GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/general_tools.html">General Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/qgis_configuration.html">QGIS Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_projections/working_with_projections.html">Working with Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qgis_browser/qgis_browser.html">QGIS Browser</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Working with Vector Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_raster/index.html">Working with Raster Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_ogc/index.html">Working with OGC Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_gps/index.html">Working with GPS Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auth_system/index.html">Authentication System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grass_integration/grass_integration.html">GRASS GIS Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing/index.html">QGIS processing framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../print_composer/index.html">Print Composer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/plugins_index.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/help_and_support.html">Help and Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendices/appendices.html">Appendix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../literature_web/literature_and_web_references.html">Literature and Web References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="http://docs.qgis.org/testing/pdf/">User guide/Manual PDF&#8217;s</a></li>
</ul>

        </div>
      </div>
                <div class="span8">
                    
                        
                            <p><span class="disclaimer">Docs for &#8216;QGIS testing&#8217;. Visit http://docs.qgis.org/2.14 for QGIS 2.14 docs and translations.</span></p>
<div class="section" id="expressions">
<span id="vector-expressions"></span><span id="index-0"></span><h1>Expressions<a class="headerlink" href="#expressions" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#functions-list" id="id3">Functions List</a><ul>
<li><a class="reference internal" href="#operators" id="id4">Operators</a></li>
<li><a class="reference internal" href="#conditionals" id="id5">Conditionals</a></li>
<li><a class="reference internal" href="#mathematical-functions" id="id6">Mathematical Functions</a></li>
<li><a class="reference internal" href="#aggregates" id="id7">Aggregates</a></li>
<li><a class="reference internal" href="#color-functions" id="id8">Color Functions</a></li>
<li><a class="reference internal" href="#conversions" id="id9">Conversions</a></li>
<li><a class="reference internal" href="#custom-functions" id="id10">Custom functions</a></li>
<li><a class="reference internal" href="#date-and-time-functions" id="id11">Date and Time Functions</a></li>
<li><a class="reference internal" href="#fields-and-values" id="id12">Fields and Values</a></li>
<li><a class="reference internal" href="#fuzzy-matching-functions" id="id13">Fuzzy Matching Functions</a></li>
<li><a class="reference internal" href="#general-functions" id="id14">General Functions</a></li>
<li><a class="reference internal" href="#geometry-functions" id="id15">Geometry Functions</a></li>
<li><a class="reference internal" href="#record-functions" id="id16">Record Functions</a></li>
<li><a class="reference internal" href="#string-functions" id="id17">String Functions</a></li>
<li><a class="reference internal" href="#recent-functions" id="id18">Recent Functions</a></li>
<li><a class="reference internal" href="#variables-functions" id="id19">Variables Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#function-editor" id="id20">Function Editor</a></li>
</ul>
</div>
<p>The <span class="target" id="index-1"></span>Expressions feature is available from many parts in QGIS. It can be
accessed using the <a class="reference internal" href="../../../_images/mIconExpression.png"><img alt="expression" src="../../../_images/mIconExpression.png" style="width: 1.5em;" /></a> <sup>Expression Builder</sup>, the
<a class="reference internal" href="../../../_images/mIconExpressionSelect.png"><img alt="expressionSelect" src="../../../_images/mIconExpressionSelect.png" style="width: 1.5em;" /></a> <sup>Select By Expression...</sup>, the <em class="guilabel">Geometry generator</em>
symbol layer option, the <a class="reference internal" href="../../../_images/mActionCalculateField.png"><img alt="calculateField" src="../../../_images/mActionCalculateField.png" style="width: 1.5em;" /></a> <sup>Field calculator</sup> or the
<a class="reference internal" href="../../../_images/mIconDataDefine.png"><img alt="dataDefined" src="../../../_images/mIconDataDefine.png" style="width: 1.5em;" /></a> <sup>Data defined override</sup> tool.
Based on layer data and prebuilt or user defined functions,
it offers a powerful way to manipulate attribute value, geometry and variables in
order to dynamically change the geometry style, the content or position
of the label, the value for diagram, the height of a composer item,
select some features, create virtual field ...</p>
<p><strong>Some examples:</strong></p>
<ul>
<li><p class="first">From Field Calculator, calculate a &#8220;pop_density&#8221; field using existing &#8220;total_pop&#8221;
and &#8220;area_km2&#8221; fields:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&quot;total_pop&quot;</span> <span class="o">/</span> <span class="s">&quot;area_km2&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Update the field &#8220;density_level&#8221; with categories according to the &#8220;pop_density&#8221; values:</p>
<div class="highlight-python"><pre>CASE WHEN "pop_density" &lt; 50 THEN 'Low population density'
     WHEN "pop_density" &gt;= 50 and "pop_density" &lt; 150 THEN 'Medium population density'
     WHEN "pop_density" &gt;= 150 THEN 'High population density'
END</pre>
</div>
</li>
<li><p class="first">Apply a categorized style to all the features according to whether their average house
price is smaller or higher than 10000€ per square metre:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&quot;price_m2&quot;</span> <span class="o">&gt;</span> <span class="mi">10000</span>
</pre></div>
</div>
</li>
<li><p class="first">Using the &#8220;Select By Expression...&#8221; tool, select all the features representing
areas of “High population density” and whose average house price is higher than
10000€ per square metre:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&quot;density_level&quot;</span> <span class="o">=</span> <span class="s">&#39;High population density&#39;</span> <span class="ow">and</span> <span class="s">&quot;price_m2&quot;</span> <span class="o">&gt;</span> <span class="mi">10000</span>
</pre></div>
</div>
</li>
</ul>
<p>Likewise, the previous expression could also be used to define which features
should be labeled or shown in the map. Using expressions offers you a lot of
possibilities.</p>
<p>The <strong>Expressions</strong> feature offers access to the:</p>
<ul class="simple">
<li><em class="guilabel">Expression</em> tab which lists functions to use</li>
<li><em class="guilabel">Function Editor</em> tab which helps to create custom functions
to use in the expressions.</li>
</ul>
<div class="admonition tip" id="index-2">
<p class="first admonition-title">Tip</p>
<p><strong>Use named parameters to improve the expression reading</strong></p>
<p class="last">Some functions requiere many parameters to be set. The expression engine supports the
use of named parameters. This means that instead of writing the cryptic expression
<tt class="docutils literal"><span class="pre">clamp(</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">9)</span></tt>, you can use <tt class="docutils literal"><span class="pre">clamp(</span> <span class="pre">min:=1,</span> <span class="pre">value:=2,</span> <span class="pre">max:=9)</span></tt>. This also allows
arguments to be switched, e.g. <tt class="docutils literal"><span class="pre">clamp(</span> <span class="pre">value:=2,</span> <span class="pre">max:=9,</span> <span class="pre">min:=1)</span></tt>. Using named parameters
helps clarify what the arguments for an expression function refer to, which is helpful
when you are trying to interpret an expression at a later date!</p>
</div>
<div class="section" id="functions-list">
<span id="id1"></span><h2><a class="toc-backref" href="#id3">Functions List</a><a class="headerlink" href="#functions-list" title="Permalink to this headline">¶</a></h2>
<p id="figure-expression-1"><strong>Figure Expression 1:</strong></p>
<div class="figure align-center">
<img alt="../../../_images/function_list.png" src="../../../_images/function_list.png" />
<p class="caption">The Expression tab</p>
</div>
<p>The <strong>Expression</strong> tab contains functions as well as layer&#8217;s fields and values.
It contains widgets to:</p>
<ul class="simple">
<li>type expressions using functions and/or fields. A preview of the expression&#8217;s
result is displayed at the bottom of the dialog.</li>
<li>select the appropriate function among a list. A search box is available to
filter the list and quickly find a particular function or field.
Double-clicking on the item&#8217;s name adds it to the expression being written.</li>
<li>display help for each function selected. When a field is selected, this widget
shows a sample of its values. Double-clicking a value adds it to the expression.</li>
</ul>
<p>To help to quickly find a function, they are organized in groups.
In <em class="guilabel">Operators</em>, you find mathematical operators.
Look in <em class="guilabel">Math</em> for mathematical functions.
The <em class="guilabel">Conversions</em> group contains functions that convert one
data type to another.
The <em class="guilabel">String</em> group provides functions for data strings,
such as <em class="guilabel">Date and Time</em> handles date and time data.
In the <em class="guilabel">Geometry</em> group, you find functions for geometry objects.
With <em class="guilabel">Record</em> group functions, you can add a numeration to your data set
while <em class="guilabel">Fields and Values</em> group helps view all attributes of the attribute table.
The <em class="guilabel">Customs</em> group lists the functions created or imported by the user.
There are many other groups, listed below.</p>
<div class="section" id="operators">
<span id="index-3"></span><h3><a class="toc-backref" href="#id4">Operators</a><a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h3>
<p>This group contains operators (e.g., +, -, *).
Note that for most of the mathematical functions below,
if one of the inputs is NULL then the result is NULL.</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a + b</td>
<td>Addition of two values (a plus b)</td>
</tr>
<tr class="row-odd"><td>a - b</td>
<td>Subtraction of two values (a minus b).</td>
</tr>
<tr class="row-even"><td>a * b</td>
<td>Multiplication of two values (a multiplied by b)</td>
</tr>
<tr class="row-odd"><td>a / b</td>
<td>Division of two values (a divided by b)</td>
</tr>
<tr class="row-even"><td>a % b</td>
<td>Remainder of division of a by b
(eg, 7 % 2 = 1, or 2 fits into 7 three times with remainder 1)</td>
</tr>
<tr class="row-odd"><td>a ^ b</td>
<td>Power of two values (for example, 2^2=4 or 2^3=8)</td>
</tr>
<tr class="row-even"><td>a &lt; b</td>
<td>Compares two values and evaluates to 1 if the left value is
less than the right value (a is smaller than b)</td>
</tr>
<tr class="row-odd"><td>a &lt;= b</td>
<td>Compares two values and evaluates to 1 if the left value is
less than or equal to the right value</td>
</tr>
<tr class="row-even"><td>a &lt;&gt; b</td>
<td>Compares two values and evaluates to 1 if they are not equal</td>
</tr>
<tr class="row-odd"><td>a = b</td>
<td>Compares two values and evaluates to 1 if they are equal</td>
</tr>
<tr class="row-even"><td>a != b</td>
<td>a and b are not equal</td>
</tr>
<tr class="row-odd"><td>a &gt; b</td>
<td>Compares two values and evaluates to 1 if the left value is
greater than the right value (a is larger than b)</td>
</tr>
<tr class="row-even"><td>a &gt;= b</td>
<td>Compares two values and evaluates to 1 if the left value is
greater than or equal to the right value</td>
</tr>
<tr class="row-odd"><td>a ~ b</td>
<td>a matches the regular expression b</td>
</tr>
<tr class="row-even"><td>||</td>
<td>Joins two values together into a string.
If one of the values is NULL the result will be NULL</td>
</tr>
<tr class="row-odd"><td>&#8216;\n&#8217;</td>
<td>Inserts a new line in a string</td>
</tr>
<tr class="row-even"><td>LIKE</td>
<td>Returns 1 if the first parameter matches the supplied pattern</td>
</tr>
<tr class="row-odd"><td>ILIKE</td>
<td>Returns 1 if the first parameter matches case-insensitive the
supplied pattern (ILIKE can be used instead of LIKE to make
the match case-insensitive)</td>
</tr>
<tr class="row-even"><td>a IS b</td>
<td>Tests whether two values are identical. Returns 1 if a is the same as b</td>
</tr>
<tr class="row-odd"><td>a OR b</td>
<td>Returns 1 when condition a or b is true</td>
</tr>
<tr class="row-even"><td>a AND b</td>
<td>Returns 1 when condition a and b are true</td>
</tr>
<tr class="row-odd"><td>NOT</td>
<td>Negates a condition</td>
</tr>
<tr class="row-even"><td>column name &#8220;column name&#8221;</td>
<td>Value of the field column name, take care to not be confused
with simple quote, see below</td>
</tr>
<tr class="row-odd"><td>&#8216;string&#8217;</td>
<td>a string value, take care to not be confused with double
quote, see above</td>
</tr>
<tr class="row-even"><td>NULL</td>
<td>null value</td>
</tr>
<tr class="row-odd"><td>a IS NULL</td>
<td>a has no value</td>
</tr>
<tr class="row-even"><td>a IS NOT NULL</td>
<td>a has a value</td>
</tr>
<tr class="row-odd"><td>a IN (value[,value])</td>
<td>a is below the values listed</td>
</tr>
<tr class="row-even"><td>a NOT IN (value[,value])</td>
<td>a is not below the values listed</td>
</tr>
</tbody>
</table>
<p><strong>Some examples:</strong></p>
<ul>
<li><p class="first">Joins a string and a value from a column name:</p>
<div class="highlight-python"><pre>'My feature''s id is: ' || "gid"</pre>
</div>
</li>
<li><p class="first">Test if the &#8220;description&#8221; attribute field starts with the &#8216;Hello&#8217; string
in the value (note the position of the % character):</p>
<div class="highlight-python"><pre>"description" LIKE 'Hello%'</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="conditionals">
<h3><a class="toc-backref" href="#id5">Conditionals</a><a class="headerlink" href="#conditionals" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions to handle conditional checks in expressions.</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CASE WHEN ... THEN ... END</td>
<td>Evaluates an expression and returns a result if true.
You can test multiple conditions</td>
</tr>
<tr class="row-odd"><td>CASE WHEN ... THEN ... ELSE ... END</td>
<td>Evaluates an expression and returns a different result
whether it&#8217;s true or false. You can test multiple conditions</td>
</tr>
<tr class="row-even"><td>coalesce</td>
<td>Returns the first non-NULL value from the expression list</td>
</tr>
<tr class="row-odd"><td>if</td>
<td>Tests a condition and returns a different result
depending on the conditional check</td>
</tr>
<tr class="row-even"><td>regexp_match</td>
<td>Returns true if any part of a string matches the supplied
regular expression</td>
</tr>
</tbody>
</table>
<p><strong>Some example:</strong></p>
<ul>
<li><p class="first">Send back a value if the first condition is true, else another value:</p>
<div class="highlight-python"><pre>CASE WHEN "software" LIKE '%QGIS%' THEN 'QGIS' ELSE 'Other' END</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="mathematical-functions">
<h3><a class="toc-backref" href="#id6">Mathematical Functions</a><a class="headerlink" href="#mathematical-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains math functions (e.g., square root, sin and cos).</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>abs</td>
<td>Returns the absolute value of a number</td>
</tr>
<tr class="row-odd"><td>acos</td>
<td>Returns the inverse cosine of a value in radians</td>
</tr>
<tr class="row-even"><td>asin</td>
<td>Returns the inverse sine of a value in radians</td>
</tr>
<tr class="row-odd"><td>atan</td>
<td>Returns the inverse cosine of a value in radians</td>
</tr>
<tr class="row-even"><td>atan2(y,x)</td>
<td>Returns the inverse tangent of y/x by using the signs
of the two arguments to determine the quadrant of the result</td>
</tr>
<tr class="row-odd"><td>azimuth(a,b)</td>
<td>Returns the north-based azimuth as the angle in radians
measured clockwise from the vertical on point a to point b</td>
</tr>
<tr class="row-even"><td>ceil</td>
<td>Rounds a number upwards</td>
</tr>
<tr class="row-odd"><td>clamp</td>
<td>Restricts an input value to a specified range</td>
</tr>
<tr class="row-even"><td>cos</td>
<td>Returns the cosine of a value in radians</td>
</tr>
<tr class="row-odd"><td>degrees</td>
<td>Converts from radians to degrees</td>
</tr>
<tr class="row-even"><td>exp</td>
<td>Returns exponential of a value</td>
</tr>
<tr class="row-odd"><td>floor</td>
<td>Rounds a number downwards</td>
</tr>
<tr class="row-even"><td>ln</td>
<td>Returns the natural logarithm of the passed expression</td>
</tr>
<tr class="row-odd"><td>log</td>
<td>Returns the value of the logarithm of the passed value and base</td>
</tr>
<tr class="row-even"><td>log10</td>
<td>Returns the value of the base 10 logarithm of the passed expression</td>
</tr>
<tr class="row-odd"><td>max</td>
<td>Returns the largest value in a set of values</td>
</tr>
<tr class="row-even"><td>min</td>
<td>Returns the smallest value in a set of values</td>
</tr>
<tr class="row-odd"><td>pi</td>
<td>Returns the value of pi for calculations</td>
</tr>
<tr class="row-even"><td>radians</td>
<td>Converts from degrees to radians</td>
</tr>
<tr class="row-odd"><td>rand</td>
<td>Returns the random integer within the range specified by
the minimum and maximum argument (inclusive)</td>
</tr>
<tr class="row-even"><td>randf</td>
<td>Returns the random float within the range specified by
the minimum and maximum argument (inclusive)</td>
</tr>
<tr class="row-odd"><td>round</td>
<td>Rounds to number of decimal places</td>
</tr>
<tr class="row-even"><td>scale_exp</td>
<td>Transforms a given value from an input domain
to an output range using an exponential curve</td>
</tr>
<tr class="row-odd"><td>scale_linear</td>
<td>Transforms a given value from an input domain
to an output range using linear interpolation</td>
</tr>
<tr class="row-even"><td>sin</td>
<td>Returns the sine of an angle</td>
</tr>
<tr class="row-odd"><td>sqrt</td>
<td>Returns the square root of a value</td>
</tr>
<tr class="row-even"><td>tan</td>
<td>Returns the tangent of an angle</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aggregates">
<h3><a class="toc-backref" href="#id7">Aggregates</a><a class="headerlink" href="#aggregates" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions which aggregate values over layers and fields.</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>aggregate</td>
<td>Returns an aggregate value calculated using features from
another layer</td>
</tr>
<tr class="row-odd"><td>concatenate</td>
<td>Returns the all aggregated strings from a field or expression
joined by a delimiter</td>
</tr>
<tr class="row-even"><td>count</td>
<td>Returns the count of matching features</td>
</tr>
<tr class="row-odd"><td>count_distinct</td>
<td>Returns the count of distinct values</td>
</tr>
<tr class="row-even"><td>count_missing</td>
<td>Returns the count of missing (null) values</td>
</tr>
<tr class="row-odd"><td>iqr</td>
<td>Returns the calculated inter quartile range from a field
or expression</td>
</tr>
<tr class="row-even"><td>majority</td>
<td>Returns the aggregate majority of values (most commonly
occurring value) from a field or expression</td>
</tr>
<tr class="row-odd"><td>max_length</td>
<td>Returns the maximum length of strings from a field or expression</td>
</tr>
<tr class="row-even"><td>maximum</td>
<td>Returns the aggregate maximum value from a field or expression</td>
</tr>
<tr class="row-odd"><td>mean</td>
<td>Returns the aggregate mean value from a field or expression</td>
</tr>
<tr class="row-even"><td>median</td>
<td>Returns the aggregate median value from a field or expression</td>
</tr>
<tr class="row-odd"><td>min_length</td>
<td>Returns the minimum length of strings from a field or expression</td>
</tr>
<tr class="row-even"><td>minimum</td>
<td>Returns the aggregate minimum value from a field or expression</td>
</tr>
<tr class="row-odd"><td>minority</td>
<td>Returns the aggregate minority of values (least commonly
occurring value) from a field or expression</td>
</tr>
<tr class="row-even"><td>q1</td>
<td>Returns the calculated first quartile from a field or expression</td>
</tr>
<tr class="row-odd"><td>q3</td>
<td>Returns the calculated third quartile from a field or expression</td>
</tr>
<tr class="row-even"><td>range</td>
<td>Returns the aggregate range of values (maximum - minimum)
from a field or expression</td>
</tr>
<tr class="row-odd"><td>relation_aggregate</td>
<td>Returns an aggregate value calculated using all matching child
features from a layer relation</td>
</tr>
<tr class="row-even"><td>stdev</td>
<td>Returns the aggregate standard deviation value from a field
or expression</td>
</tr>
<tr class="row-odd"><td>sum</td>
<td>Returns the aggregate summed value from a field or expression</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<ul>
<li><p class="first">Return the maximum of the &#8220;passengers&#8221; field from features in the layer
grouped by &#8220;station_class&#8221; field:</p>
<div class="highlight-python"><pre>maximum("passengers", group_by:="station_class")</pre>
</div>
</li>
<li><p class="first">Calculate the total number of passengers for the stations inside the current
atlas feature:</p>
<div class="highlight-python"><pre>aggregate('rail_stations','sum',"passengers", intersects(@atlas_geometry, $geometry))</pre>
</div>
</li>
<li><p class="first">Return the mean of the &#8220;field_from_related_table&#8221; field for all matching
child features using the &#8216;my_relation&#8217; relation from the layer:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">aggregate_relation</span><span class="p">(</span><span class="s">&#39;my_relation&#39;</span><span class="p">,</span> <span class="s">&#39;mean&#39;</span><span class="p">,</span> <span class="s">&quot;field_from_related_table&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><pre>aggregate_relation(relation:='my_relation', calculation := 'mean', expression := "field_from_related_table")</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="color-functions">
<h3><a class="toc-backref" href="#id8">Color Functions</a><a class="headerlink" href="#color-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions for manipulating colors.</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>color_cmyk</td>
<td>Returns a string representation of a color based on its
cyan, magenta, yellow and black components</td>
</tr>
<tr class="row-odd"><td>color_cmyka</td>
<td>Returns a string representation of a color based on its cyan,
magenta, yellow, black and alpha (transparency) components</td>
</tr>
<tr class="row-even"><td>color_hsl</td>
<td>Returns a string representation of a color based on its
hue, saturation, and lightness attributes</td>
</tr>
<tr class="row-odd"><td>color_hsla</td>
<td>Returns a string representation of a color based on its hue,
saturation, lightness and alpha (transparency) attributes</td>
</tr>
<tr class="row-even"><td>color_hsv</td>
<td>Returns a string representation of a color based on its
hue, saturation, and value attributes</td>
</tr>
<tr class="row-odd"><td>color_hsva</td>
<td>Returns a string representation of a color based on its
hue, saturation, value and alpha (transparency) attributes</td>
</tr>
<tr class="row-even"><td>color_part</td>
<td>Returns a specific component from a color string,
eg the red component or alpha component</td>
</tr>
<tr class="row-odd"><td>color_rgb</td>
<td>Returns a string representation of a color based on its
red, green, and blue components</td>
</tr>
<tr class="row-even"><td>color_rgba</td>
<td>Returns a string representation of a color based on its
red, green, blue, and alpha (transparency) components</td>
</tr>
<tr class="row-odd"><td>darker</td>
<td>Returns a darker (or lighter) color string</td>
</tr>
<tr class="row-even"><td>lighter</td>
<td>Returns a lighter (or darker) color string</td>
</tr>
<tr class="row-odd"><td>project_color</td>
<td>Returns a color from the project&#8217;s color scheme</td>
</tr>
<tr class="row-even"><td>ramp_color</td>
<td>Returns a string representing a color from a color ramp</td>
</tr>
<tr class="row-odd"><td>set_color_part</td>
<td>Sets a specific color component for a color string,
eg the red component or alpha component</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="conversions">
<h3><a class="toc-backref" href="#id9">Conversions</a><a class="headerlink" href="#conversions" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions to convert one data type to another
(e.g., string to integer, integer to string).</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>to_date</td>
<td>Converts a string into a date object</td>
</tr>
<tr class="row-odd"><td>to_datetime</td>
<td>Converts a string into a datetime object</td>
</tr>
<tr class="row-even"><td>to_int</td>
<td>Converts a string to integer number</td>
</tr>
<tr class="row-odd"><td>to_interval</td>
<td>Converts a string to an interval type (can be used
to take days, hours, months, etc. of a date)</td>
</tr>
<tr class="row-even"><td>to_real</td>
<td>Converts a string to a real number</td>
</tr>
<tr class="row-odd"><td>to_string</td>
<td>Converts number to string</td>
</tr>
<tr class="row-even"><td>to_time</td>
<td>Converts a string into a time object</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="custom-functions">
<h3><a class="toc-backref" href="#id10">Custom functions</a><a class="headerlink" href="#custom-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions created by the user.
See <a class="reference internal" href="#function-editor">function_editor</a> for more details.</p>
</div>
<div class="section" id="date-and-time-functions">
<h3><a class="toc-backref" href="#id11">Date and Time Functions</a><a class="headerlink" href="#date-and-time-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions for handling date and time data.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>age</td>
<td>Returns as an interval the difference between two dates or datetimes</td>
</tr>
<tr class="row-odd"><td>day</td>
<td>Extracts the day from a date or datetime, or the number of days
from an interval</td>
</tr>
<tr class="row-even"><td>day_of_week</td>
<td>Returns a number corresponding to the day of the week
for a specified date or datetime</td>
</tr>
<tr class="row-odd"><td>hour</td>
<td>Extracts the hour from a datetime or time, or the number
of hours from an interval</td>
</tr>
<tr class="row-even"><td>minute</td>
<td>Extracts the minute from a datetime or time, or the number
of minutes from an interval</td>
</tr>
<tr class="row-odd"><td>month</td>
<td>Extracts the month part from a date or datetime, or the number of
months from an interval</td>
</tr>
<tr class="row-even"><td>now()</td>
<td>Returns current date and time</td>
</tr>
<tr class="row-odd"><td>second</td>
<td>Extracts the second from a datetime or time, or the number
of seconds from an interval</td>
</tr>
<tr class="row-even"><td>week</td>
<td>Extracts the week number from a date or datetime, or the number of
weeks from an interval</td>
</tr>
<tr class="row-odd"><td>year</td>
<td>Extracts the year part from a date or datetime, or the number of
years from an interval</td>
</tr>
</tbody>
</table>
<p><strong>Some example:</strong></p>
<ul>
<li><p class="first">Get the month and the year of today in the format &#8220;10/2014&#8221;:</p>
<div class="highlight-python"><pre>month(now()) || '/' || year(now())</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="fields-and-values">
<h3><a class="toc-backref" href="#id12">Fields and Values</a><a class="headerlink" href="#fields-and-values" title="Permalink to this headline">¶</a></h3>
<p>Contains a list of fields from the layer.</p>
<p>Generally, you can use the various fields,
values and functions to construct the calculation expression, or you can just
type it into the box.</p>
<p>To display the values of a field, you just click on the
appropriate field and choose between <em class="guilabel">Load top 10 unique values</em>
and <em class="guilabel">Load all unique values</em>. On the right side, the <strong>Field Values</strong>
list opens with the unique values. At the top of the list, a search box helps
filtering the values. To add a value to the expression you are writing,
double click its name in the list.</p>
<p>Sample values can also be accessed via right-click.
Select the field name from the list, then right-click to access a context menu
with options to load sample values from the selected field.</p>
<p>Fields name should be double-quoted in the expression.
Values or string should be simple-quoted.</p>
</div>
<div class="section" id="fuzzy-matching-functions">
<h3><a class="toc-backref" href="#id13">Fuzzy Matching Functions</a><a class="headerlink" href="#fuzzy-matching-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions for fuzzy comparisons between values.</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>hamming_distance</td>
<td>Returns the number of characters at
corresponding positions within the input
strings where the characters are different</td>
</tr>
<tr class="row-odd"><td>levensheim</td>
<td>Returns the minimum number of character edits
(insertions, deletions or substitutions)
required to change one string to another.
Measure the similarity between two strings</td>
</tr>
<tr class="row-even"><td>longest_common_substring</td>
<td>Returns the longest common substring between
two strings</td>
</tr>
<tr class="row-odd"><td>soundex</td>
<td>Returns the Soundex representation of a string</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="general-functions">
<h3><a class="toc-backref" href="#id14">General Functions</a><a class="headerlink" href="#general-functions" title="Permalink to this headline">¶</a></h3>
<p>This group  contains general assorted functions.</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>eval</td>
<td>Evaluates an expression which is passed in a string.
Useful to expand dynamic parameters passed as context
variables or fields</td>
</tr>
<tr class="row-odd"><td>layer_property</td>
<td>Returns a property of a layer or a value of its
metadata. It can be layer name, crs, geometry type,
feature count...</td>
</tr>
<tr class="row-even"><td>var</td>
<td>Returns the value stored within a specified
variable. See variable functions below</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="geometry-functions">
<h3><a class="toc-backref" href="#id15">Geometry Functions</a><a class="headerlink" href="#geometry-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions that operate on geometry objects (e.g., length, area).</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>$area</td>
<td>Returns the area size of the current feature</td>
</tr>
<tr class="row-odd"><td>$geometry</td>
<td>Returns the geometry of the current feature (can be
used for processing with other functions)</td>
</tr>
<tr class="row-even"><td>$length</td>
<td>Returns the length of the current line feature</td>
</tr>
<tr class="row-odd"><td>$perimeter</td>
<td>Returns the perimeter of the current polygon feature</td>
</tr>
<tr class="row-even"><td>$x</td>
<td>Returns the x coordinate of the current feature</td>
</tr>
<tr class="row-odd"><td>$x_at(n)</td>
<td>Returns the x coordinate of the nth node of the current
feature&#8217;s geometry</td>
</tr>
<tr class="row-even"><td>$y</td>
<td>Returns the y coordinate of the current feature</td>
</tr>
<tr class="row-odd"><td>$y_at(n)</td>
<td>Returns the y coordinate of the nth node
of the current feature&#8217;s geometry</td>
</tr>
<tr class="row-even"><td>area</td>
<td>Returns the area of a geometry polygon feature.
Calculations are in the Spatial
Reference System of this geometry</td>
</tr>
<tr class="row-odd"><td>bounds</td>
<td>Returns a geometry which represents the bounding box of
an input geometry. Calculations are in the Spatial
Reference System of this Geometry</td>
</tr>
<tr class="row-even"><td>bounds_height</td>
<td>Returns the height of the bounding box of a geometry.
Calculations are in the Spatial Reference System of
this Geometry</td>
</tr>
<tr class="row-odd"><td>bounds_width</td>
<td>Returns the width of the bounding box of a geometry.
Calculations are in the Spatial Reference System of
this Geometry</td>
</tr>
<tr class="row-even"><td>buffer</td>
<td>Returns a geometry that represents all points whose
distance from this geometry is less than or equal to
distance. Calculations are in the Spatial Reference
System of this geometry</td>
</tr>
<tr class="row-odd"><td>centroid</td>
<td>Returns the geometric center of a geometry</td>
</tr>
<tr class="row-even"><td>closest_point</td>
<td>Returns the point on a geometry that is closest to a second geometry</td>
</tr>
<tr class="row-odd"><td>combine</td>
<td>Returns the combination of two geometries</td>
</tr>
<tr class="row-even"><td>contains(a,b)</td>
<td>Returns 1 (true) if and only if no points of b lie in the
exterior of a, and at least one point of the interior
of b lies in the interior of a</td>
</tr>
<tr class="row-odd"><td>convex_hull</td>
<td>Returns the convex hull of a geometry (this represents
the minimum convex geometry that encloses all geometries
within the set)</td>
</tr>
<tr class="row-even"><td>crosses</td>
<td>Returns 1 (true) if the supplied geometries have some,
but not all, interior points in common</td>
</tr>
<tr class="row-odd"><td>difference(a,b)</td>
<td>Returns a geometry that represents that part of geometry
a that does not intersect with geometry b</td>
</tr>
<tr class="row-even"><td>disjoint</td>
<td>Returns 1 (true) if the geometries do not share any space
together</td>
</tr>
<tr class="row-odd"><td>distance</td>
<td>Returns the minimum distance (based on spatial ref)
between two geometries in projected units</td>
</tr>
<tr class="row-even"><td>end_point</td>
<td>Returns the last node from a geometry</td>
</tr>
<tr class="row-odd"><td>exterior_ring</td>
<td>Returns a line string representing the exterior ring
of a polygon geometry. If the geometry is not a polygon
then the result will be null</td>
</tr>
<tr class="row-even"><td>extrude(geom,x,y)</td>
<td>Returns an extruded version of the input (Multi-)Curve
or (Multi-)Linestring geometry with an extension
specified by x and y</td>
</tr>
<tr class="row-odd"><td>geom_from_gml</td>
<td>Returns a geometry created from a GML representation of
geometry</td>
</tr>
<tr class="row-even"><td>geom_from_wkt</td>
<td>Returns a geometry created from a well-known text (WKT)
representation</td>
</tr>
<tr class="row-odd"><td>geom_to_wkt</td>
<td>Returns the well-known text (WKT) representation of the
geometry without SRID metadata</td>
</tr>
<tr class="row-even"><td>geometry</td>
<td>Returns a feature&#8217;s geometry</td>
</tr>
<tr class="row-odd"><td>geometry_n</td>
<td>Returns the nth geometry from a geometry collection,
or null if the input geometry is not a collection</td>
</tr>
<tr class="row-even"><td>interior_ring_n</td>
<td>Returns the geometry of the nth interior ring from a
polygon geometry, or null if the geometry is not a
polygon</td>
</tr>
<tr class="row-odd"><td>intersection</td>
<td>Returns a geometry that represents the shared portion
of two geometries</td>
</tr>
<tr class="row-even"><td>intersects</td>
<td>Tests whether a geometry intersects another.
Returns 1 (true) if the geometries spatially intersect
(share any portion of space) and 0 if they don&#8217;t</td>
</tr>
<tr class="row-odd"><td>intersects_bbox</td>
<td>Tests whether a geometry&#8217;s bounding box overlaps another
geometry&#8217;s bounding box. Returns 1 (true) if the
geometries spatially intersect (share any portion of
space) their bounding box and 0 if they don&#8217;t</td>
</tr>
<tr class="row-even"><td>is_closed</td>
<td>Returns true if a line string is closed (start and end
points are coincident), false if a line string is not
closed and null if the geometry is not a line string</td>
</tr>
<tr class="row-odd"><td>length</td>
<td>Returns length of a line geometry feature
(or length of a string)</td>
</tr>
<tr class="row-even"><td>m</td>
<td>Returns the m value of a point geometry</td>
</tr>
<tr class="row-odd"><td>make_line</td>
<td>Creates a line geometry from a series of point geometries</td>
</tr>
<tr class="row-even"><td>make_point(x,y,z,m)</td>
<td>Returns a point geometry from x and y values
(and optional z and m values)</td>
</tr>
<tr class="row-odd"><td>make_point_m(x,y,m)</td>
<td>Returns a point geometry from x and y coordinates and m values</td>
</tr>
<tr class="row-even"><td>make_polygon</td>
<td>Creates a polygon geometry from an outer ring
and optional series of inner ring geometries</td>
</tr>
<tr class="row-odd"><td>nodes_to_points</td>
<td>Returns a multipoint geometry consisting of every node
in the input geometry</td>
</tr>
<tr class="row-even"><td>num_geometries</td>
<td>Returns the number of geometries in a geometry
collection, or null if the input geometry is not a
collection</td>
</tr>
<tr class="row-odd"><td>num_interior_rings</td>
<td>Returns the number of interior rings in a polygon
or geometry collection, or null if the input geometry
is not a polygon or collection</td>
</tr>
<tr class="row-even"><td>num_points</td>
<td>Returns the number of vertices in a geometry</td>
</tr>
<tr class="row-odd"><td>num_rings</td>
<td>Returns the number of rings (including exterior rings)
in a polygon or geometry collection, or null if the input
geometry is not a polygon or collection</td>
</tr>
<tr class="row-even"><td>order_parts</td>
<td>Orders the parts of a MultiGeometry by a given criteria</td>
</tr>
<tr class="row-odd"><td>overlaps</td>
<td>Tests whether a geometry overlaps another. Returns 1 (true)
if the geometries share space, are of the same dimension,
but are not completely contained by each other</td>
</tr>
<tr class="row-even"><td>perimeter</td>
<td>Returns the perimeter of a geometry polygon feature.
Calculations are in the Spatial Reference System of this geometry</td>
</tr>
<tr class="row-odd"><td>point_n</td>
<td>Returns a specific node from a geometry</td>
</tr>
<tr class="row-even"><td>point_on_surface</td>
<td>Returns a point guaranteed to lie on the surface of a geometry</td>
</tr>
<tr class="row-odd"><td>project</td>
<td>Returns a point projected from a start point using a distance
and bearing (azimuth) in radians.</td>
</tr>
<tr class="row-even"><td>relate</td>
<td>Tests or returns the Dimensional Extended 9 Intersection
Model (DE-9IM) representation of the relationship between
two geometries</td>
</tr>
<tr class="row-odd"><td>reverse</td>
<td>Reverses the direction of a line string by reversing
the order of its vertices</td>
</tr>
<tr class="row-even"><td>segments_to_lines</td>
<td>Returns a multi line geometry consisting of a line
for every segment in the input geometry</td>
</tr>
<tr class="row-odd"><td>shortest_line</td>
<td>Returns the shortest line joining two geometries.
The resultant line will start at geometry 1 and end at geometry 2</td>
</tr>
<tr class="row-even"><td>start_point</td>
<td>Returns the first node from a geometry</td>
</tr>
<tr class="row-odd"><td>sym_difference</td>
<td>Returns a geometry that represents the portions of two geometries
that do not intersect</td>
</tr>
<tr class="row-even"><td>touches</td>
<td>Tests whether a geometry touches another.
Returns 1 (true) if the geometries have at least one
point in common, but their interiors do not intersect</td>
</tr>
<tr class="row-odd"><td>transform</td>
<td>Returns the geometry transformed from the source CRS to
the destination CRS</td>
</tr>
<tr class="row-even"><td>translate</td>
<td>Returns a translated version of a geometry. Calculations
are in the Spatial Reference System of this geometry</td>
</tr>
<tr class="row-odd"><td>union</td>
<td>Returns a geometry that represents the point set union of
the geometries</td>
</tr>
<tr class="row-even"><td>within (a,b)</td>
<td>Tests whether a geometry is within another. Returns 1 (true)
if geometry a is completely inside geometry b</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Returns the x coordinate of a point geometry, or the
x coordinate of the centroid for a non-point geometry</td>
</tr>
<tr class="row-even"><td>x_min</td>
<td>Returns the minimum x coordinate of a geometry. Calculations
are in the Spatial Reference System of this geometry</td>
</tr>
<tr class="row-odd"><td>x_max</td>
<td>Returns the maximum x coordinate of a geometry. Calculations
are in the Spatial Reference System of this geometry</td>
</tr>
<tr class="row-even"><td>y</td>
<td>Returns the y coordinate of a point geometry, or the
y coordinate of the centroid for a non-point geometry</td>
</tr>
<tr class="row-odd"><td>y_min</td>
<td>Returns the minimum y coordinate of a geometry. Calculations
are in the Spatial Reference System of this geometry</td>
</tr>
<tr class="row-even"><td>y_max</td>
<td>Returns the maximum y coordinate of a geometry. Calculations
are in the Spatial Reference System of this geometry</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>Returns the z coordinate of a point geometry</td>
</tr>
</tbody>
</table>
<p><strong>Some examples:</strong></p>
<ul>
<li><p class="first">Return the x coordinate of the current feature&#8217;s centroid:</p>
<div class="highlight-python"><pre>x($geometry)</pre>
</div>
</li>
<li><p class="first">Send back a value according to feature&#8217;s area:</p>
<div class="highlight-python"><pre>CASE WHEN $area &gt; 10 000 THEN 'Larger' ELSE 'Smaller' END</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="record-functions">
<h3><a class="toc-backref" href="#id16">Record Functions</a><a class="headerlink" href="#record-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions that operate on record identifiers.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>$currentfeature</td>
<td>Returns the current feature being evaluated.
This can be used with the &#8216;attribute&#8217; function
to evaluate attribute values from the current feature.</td>
</tr>
<tr class="row-odd"><td>$id</td>
<td>Returns the feature id of the current row</td>
</tr>
<tr class="row-even"><td>$map</td>
<td>Returns the id of the current map item if the map
is being drawn in a composition, or &#8220;canvas&#8221; if
the map is being drawn within the main QGIS window</td>
</tr>
<tr class="row-odd"><td>$rownum</td>
<td>Returns the number of the current row</td>
</tr>
<tr class="row-even"><td>$scale</td>
<td>Returns the current scale of the map canvas</td>
</tr>
<tr class="row-odd"><td>attribute</td>
<td>Returns the value of a specified attribute from a feature.</td>
</tr>
<tr class="row-even"><td>get_feature</td>
<td>Returns the first feature of a layer matching a
given attribute value.</td>
</tr>
<tr class="row-odd"><td>uuid</td>
<td>Generates a Universally Unique Identifier (UUID)
for each row. Each UUID is 38 characters long</td>
</tr>
</tbody>
</table>
<p><strong>Some examples:</strong></p>
<ul>
<li><p class="first">Return the first feature in layer &#8220;LayerA&#8221; whose field &#8220;id&#8221; has the same value
as the field &#8220;name&#8221; of the current feature (a kind of jointure):</p>
<div class="highlight-python"><pre>get_feature( 'layerA', 'id', attribute( $currentfeature, 'name') )</pre>
</div>
</li>
<li><p class="first">Calculate the area of the joined feature from the previous example:</p>
<div class="highlight-python"><pre>area( geometry( get_feature( 'layerA', 'id', attribute( $currentfeature, 'name') ) ) )</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="string-functions">
<h3><a class="toc-backref" href="#id17">String Functions</a><a class="headerlink" href="#string-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains functions that operate on strings
(e.g., that replace, convert to upper case).</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>char</td>
<td>Returns the character associated with a unicode code</td>
</tr>
<tr class="row-odd"><td>concat</td>
<td>Concatenates several strings to one</td>
</tr>
<tr class="row-even"><td>format</td>
<td>Formats a string using supplied arguments</td>
</tr>
<tr class="row-odd"><td>format_date</td>
<td>Formats a date type or string into a custom string format</td>
</tr>
<tr class="row-even"><td>format_number</td>
<td>Returns a number formatted with the locale
separator for thousands (also truncates the
number to the number of supplied places)</td>
</tr>
<tr class="row-odd"><td>left(string, n)</td>
<td>Returns a substring that contains the n
leftmost characters of the string</td>
</tr>
<tr class="row-even"><td>length</td>
<td>Returns length of a string
(or length of a line geometry feature)</td>
</tr>
<tr class="row-odd"><td>lower</td>
<td>converts a string to lower case</td>
</tr>
<tr class="row-even"><td>lpad</td>
<td>Returns a string with supplied width padded
using the fill character</td>
</tr>
<tr class="row-odd"><td>regexp_replace</td>
<td>Returns a string with the supplied regular
expression replaced</td>
</tr>
<tr class="row-even"><td>regexp_substr</td>
<td>Returns the portion of a string which matches
a supplied regular expression</td>
</tr>
<tr class="row-odd"><td>replace</td>
<td>Returns a string with the supplied string
replaced</td>
</tr>
<tr class="row-even"><td>right(string, n)</td>
<td>Returns a substring that contains the n
rightmost characters of the string</td>
</tr>
<tr class="row-odd"><td>rpad</td>
<td>Returns a string with supplied width padded
using the fill character</td>
</tr>
<tr class="row-even"><td>strpos</td>
<td>Returns the index of a regular expression
in a string</td>
</tr>
<tr class="row-odd"><td>substr</td>
<td>Returns a part of a string</td>
</tr>
<tr class="row-even"><td>title</td>
<td>Converts all words of a string to title
case (all words lower case with leading
capital letter)</td>
</tr>
<tr class="row-odd"><td>trim</td>
<td>Removes all leading and trailing white
space (spaces, tabs, etc.) from a string</td>
</tr>
<tr class="row-even"><td>upper</td>
<td>Converts string a to upper case</td>
</tr>
<tr class="row-odd"><td>wordwrap</td>
<td>Returns a string wrapped to a maximum/
minimum number of characters</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="recent-functions">
<h3><a class="toc-backref" href="#id18">Recent Functions</a><a class="headerlink" href="#recent-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains recently used functions. Any expression used in the
Expression dialog is added to the list, sorted from the more recent to
the less one. This helps to quickly retrieve any previous expression.</p>
</div>
<div class="section" id="variables-functions">
<h3><a class="toc-backref" href="#id19">Variables Functions</a><a class="headerlink" href="#variables-functions" title="Permalink to this headline">¶</a></h3>
<p>This group contains dynamic variables related to the application, the project
file and other settings.
It means that some functions may not be available according to the context:</p>
<ul class="simple">
<li>from the <a class="reference internal" href="../../../_images/mIconExpressionSelect.png"><img alt="expressionSelect" src="../../../_images/mIconExpressionSelect.png" style="width: 1.5em;" /></a> <sup>Select by expression</sup> dialog</li>
<li>from the <a class="reference internal" href="../../../_images/mActionCalculateField.png"><img alt="calculateField" src="../../../_images/mActionCalculateField.png" style="width: 1.5em;" /></a> <sup>Field calculator</sup> dialog</li>
<li>from the layer properties dialog</li>
<li>from the print composer</li>
</ul>
<p>To use these functions in an expression, they should be preceded by &#64; character
(e.g, &#64;row_number). Are concerned:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>atlas_feature</td>
<td>Returns the current atlas feature
(as feature object)</td>
</tr>
<tr class="row-odd"><td>atlas_featureid</td>
<td>Returns the current atlas feature ID</td>
</tr>
<tr class="row-even"><td>atlas_featurenumber</td>
<td>Returns the number of pages in composition</td>
</tr>
<tr class="row-odd"><td>atlas_filename</td>
<td>Returns the current atlas file name</td>
</tr>
<tr class="row-even"><td>atlas_geometry</td>
<td>Returns the current atlas feature geometry</td>
</tr>
<tr class="row-odd"><td>atlas_pagename</td>
<td>Returns the current atlas page name</td>
</tr>
<tr class="row-even"><td>atlas_totalfeatures</td>
<td>Returns the total number of features in atlas</td>
</tr>
<tr class="row-odd"><td>grid_axis</td>
<td>Returns the current grid annotation axis
(eg, &#8216;x&#8217; for longitude, &#8216;y&#8217; for latitude)</td>
</tr>
<tr class="row-even"><td>grid_number</td>
<td>Returns the current grid annotation value</td>
</tr>
<tr class="row-odd"><td>item_id</td>
<td>Returns the composer item user ID
(not necessarily unique)</td>
</tr>
<tr class="row-even"><td>item_uuid</td>
<td>Returns the composer item unique ID</td>
</tr>
<tr class="row-odd"><td>layer_id</td>
<td>Returns the ID of current layer</td>
</tr>
<tr class="row-even"><td>layer_name</td>
<td>Returns the name of current layer</td>
</tr>
<tr class="row-odd"><td>layout_dpi</td>
<td>Returns the composition resolution (DPI)</td>
</tr>
<tr class="row-even"><td>layout_numpages</td>
<td>Returns the number of pages in the composition</td>
</tr>
<tr class="row-odd"><td>layout_pageheight</td>
<td>Returns the composition height in mm</td>
</tr>
<tr class="row-even"><td>layout_pagewidth</td>
<td>Returns the composition width in mm</td>
</tr>
<tr class="row-odd"><td>map_id</td>
<td>Returns the ID of current map destination.
This will be &#8216;canvas&#8217; for canvas renders, and
the item ID for composer map renders</td>
</tr>
<tr class="row-even"><td>map_extent_center</td>
<td>Returns the point feature at the center of the map</td>
</tr>
<tr class="row-odd"><td>map_extent_height</td>
<td>Returns the current height of the map</td>
</tr>
<tr class="row-even"><td>map_exent_width</td>
<td>Returns the current width of the map</td>
</tr>
<tr class="row-odd"><td>map_rotation</td>
<td>Returns the current rotation of the map</td>
</tr>
<tr class="row-even"><td>map_scale</td>
<td>Returns the current scale of the map</td>
</tr>
<tr class="row-odd"><td>project_filename</td>
<td>Returns the filename of current project</td>
</tr>
<tr class="row-even"><td>project_folder</td>
<td>Returns the folder for current project</td>
</tr>
<tr class="row-odd"><td>project_path</td>
<td>Returns the full path (including file name)
of current project</td>
</tr>
<tr class="row-even"><td>project_title</td>
<td>Returns the title of current project</td>
</tr>
<tr class="row-odd"><td>qgis_os_name</td>
<td>Returns the current Operating system name,
eg &#8216;windows&#8217;, &#8216;linux&#8217; or &#8216;osx&#8217;</td>
</tr>
<tr class="row-even"><td>qgis_platform</td>
<td>Returns the QGIS platform, eg &#8216;desktop&#8217; or &#8216;server&#8217;</td>
</tr>
<tr class="row-odd"><td>qgis_release_name</td>
<td>Returns the current QGIS release name</td>
</tr>
<tr class="row-even"><td>qgis_version</td>
<td>Returns the current QGIS version string</td>
</tr>
<tr class="row-odd"><td>qgis_version_no</td>
<td>Returns the current QGIS version number</td>
</tr>
<tr class="row-even"><td>symbol_angle</td>
<td>Returns the angle of the symbol used to render
the feature (valid for marker symbols only)</td>
</tr>
<tr class="row-odd"><td>symbol_color</td>
<td>Returns the color of the symbol used to render the feature</td>
</tr>
<tr class="row-even"><td>user_account_name</td>
<td>Returns the current user&#8217;s operating system account name</td>
</tr>
<tr class="row-odd"><td>user_full_name</td>
<td>Returns the current user&#8217;s operating system user name</td>
</tr>
<tr class="row-even"><td>row_number</td>
<td>Stores the number of the current row</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="function-editor">
<span id="id2"></span><h2><a class="toc-backref" href="#id20">Function Editor</a><a class="headerlink" href="#function-editor" title="Permalink to this headline">¶</a></h2>
<p>With the Function Editor, you are able to define your own Python custom
functions in a comfortable way.</p>
<p id="figure-expression-2"><strong>Figure Expression 2:</strong></p>
<div class="figure align-center">
<img alt="../../../_images/function_editor.png" src="../../../_images/function_editor.png" />
<p class="caption">The Function Editor tab</p>
</div>
<p>The function editor will create new Python files in <tt class="file docutils literal"><span class="pre">.qgis2\python\expressions</span></tt>
folder and will auto load all functions defined when starting QGIS. Be aware
that new functions are only saved in the <tt class="file docutils literal"><span class="pre">expressions</span></tt> folder and not in
the project file. If you have a project that uses one of your custom functions
you will need to also share the .py file in the expressions folder.</p>
<p>Here&#8217;s a short example on how to create your own functions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@qgsfunction</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="s">&quot;auto&quot;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s">&#39;Custom&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">myfunc</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>The short example creates a function &#8216;myfunc&#8217; that will give you a function
with two values.
When using the args=&#8217;auto&#8217; function argument the number of function
arguments required will be calculated by the number of arguments the
function has been defined with in Python (minus 2 - feature, and parent).</p>
<p>This function then can be used with the following expression:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">myfunc</span><span class="p">(</span><span class="s">&#39;test1&#39;</span><span class="p">,</span> <span class="s">&#39;test2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Your function will be implemented in the <em class="guilabel">Custom</em> functions group of
the <em class="guilabel">Expression</em> tab after using the <em class="guilabel">Run Script</em> button.</p>
<p>Further information about creating Python code can be found in the
<em class="xref std std-ref">PyQGIS-Developer-Cookbook</em>.</p>
<p>The function editor is not only limited to working with the field calculator,
it can be found whenever you work with expressions.</p>
</div>
</div>

                        
                    
                </div>
                  
            </div>
        </div>
    

    <!--<a href="https://github.com/qgis/"><img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>-->
    <div class="related">
       
      
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="attribute_table.html" title="Working with the Attribute Table"
             >next</a></li>
        <li class="right" >
          <a href="vector_properties.html" title="The Vector Properties Dialog"
             >previous</a> |</li>
        <li><a href="../../index.html"></a> &raquo;</li>
          <li><a href="../index.html" >QGIS User Guide</a> &raquo;</li>
          <li><a href="index.html" >Working with Vector Data</a> &raquo;</li> 
      </ul>
    </div>
  <footer class="footer">

    <div class="container">
        <div>
          <ul class="unstyled inline" id="social">
            <li id="twitter"><a href="http://twitter.com/qgis" class="external"><div></div></a></li>
            <li id="facebook"><a href="https://www.facebook.com/pages/QGIS-Quantum-GIS-/298112000235096" class="external"><div></div></a></li>
            <li id="gplus"><a href="http://plus.google.com/communities/114776597176808981624" class="external"><div></div></a></li>
            <li id="github"><a href="http://github.com/qgis/" class="external"><div></div></a></li>
            <!--<li id="aboutcontact"><a href="../../../site/getinvolved/about.html"><div></div></a></li>-->
            <li id="aboutcontact"><a href="http://www.qgis.org/en/site/getinvolved/about.html"><div></div></a></li>
          </ul>
        </div>

        <p class="credit">If not stated otherwise, all content is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 licence (CC BY-SA)</a></p>
    </div>
    <div class="container">
      <p class="credit">
        Select graphics from <a href="http://thenounproject.com" target="_blank">The Noun Project collection</a>
        
        
      </p>
      <p class="credit">
        <!--
        Untranslated page? Or you spot a translation error:
        <a id="fix_translation_link" target="_blank" href="https://www.transifex.com/projects/p/qgis-documentation/">fix me</a>
        <br/>
        -->
        Textual error, missing text or you know better:
        <a id="fix_text_link" target="_blank" href="https://github.com/qgis/QGIS-Documentation">fix me</a>
      </p>
    </div>
  </footer>

  </body>
</html>